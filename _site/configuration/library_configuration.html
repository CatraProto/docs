<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Library Configuration - CatraProto Docs</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Library Configuration | CatraProto Docs</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Library Configuration" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/configuration/library_configuration.html" /> <meta property="og:url" content="http://localhost:4000/configuration/library_configuration.html" /> <meta property="og:site_name" content="CatraProto Docs" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Library Configuration" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Library Configuration","url":"http://localhost:4000/configuration/library_configuration.html"}</script> <!-- End Jekyll SEO tag --> </head> <html lang="en-US"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta charset="utf-8"> <title>Library Configuration - CatraProto Docs</title> <link rel="stylesheet" href="/assets/css/custom.css"> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> CatraProto Docs </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">Introduction</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/configuration/" class="nav-list-link">Initial configuration</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/configuration/app_configuration.html" class="nav-list-link">App Configuration</a></li><li class="nav-list-item active"><a href="http://localhost:4000/configuration/library_configuration.html" class="nav-list-link active">Library Configuration</a></li><li class="nav-list-item "><a href="http://localhost:4000/configuration/logger_configuration.html" class="nav-list-link">Logger Configuration</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/usage/" class="nav-list-link">Using the library</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/usage/invoking_api.html" class="nav-list-link">Calling API methods</a></li><li class="nav-list-item "><a href="http://localhost:4000/usage/handling_states.html" class="nav-list-link">Handling states and Logging-In</a></li><li class="nav-list-item "><a href="http://localhost:4000/usage/receiving_updates.html" class="nav-list-link">Receiving Messages (Updates)</a></li><li class="nav-list-item "><a href="http://localhost:4000/usage/init_client.html" class="nav-list-link">Library initialization</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/enhancing/" class="nav-list-link">Enhancing your experience</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:4000/enhancing/markup.html" class="nav-list-link">Styiling text</a></li><li class="nav-list-item "><a href="http://localhost:4000/enhancing/json.html" class="nav-list-link">JSON Serialization</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:4000/custom_serializer.html" class="nav-list-link">Custom session serializers</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search CatraProto Docs" aria-label="Search CatraProto Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/CatraProto/Client" class="site-button" > Source Code </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/configuration/">Initial configuration</a></li> <li class="breadcrumb-nav-list-item"><span>Library Configuration</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="configuring-catraproto"> <a href="#configuring-catraproto" class="anchor-heading" aria-labelledby="configuring-catraproto"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuring CatraProto </h1> <p>CatraProto <strong>requires</strong> some user-provided configuration data such as <a href="/configuration/app_configuration.html">API credentials</a> to work.</p> <h2 id="api-settings"> <a href="#api-settings" class="anchor-heading" aria-labelledby="api-settings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API Settings </h2> <p>The <em>ApiSettings</em> constructor takes configuration data to be <strong>transmitted to Telegram</strong> regarding the app.</p> <ul> <li><code class="language-plaintext highlighter-rouge">apiId</code> and <code class="language-plaintext highlighter-rouge">apiHash</code>, which can be retrieved by following these <a href="/configuration/app_configuration.html">instructions</a>.</li> <li><code class="language-plaintext highlighter-rouge">langPack</code> is the <a href="https://telegram.org/blog/translations-iv2">language pack</a> used by the client. Allowed values are: <em>desktop</em>, <em>android</em>, <em>ios</em>, <em>macos</em> and <em>android_x</em>.</li> <li><code class="language-plaintext highlighter-rouge">deviceModel</code>, <code class="language-plaintext highlighter-rouge">appVersion</code> and <code class="language-plaintext highlighter-rouge">systemVersion</code> are custom parameters shown to the user in its devices tab. They do not follow any standard.</li> <li><code class="language-plaintext highlighter-rouge">langCode</code> and <code class="language-plaintext highlighter-rouge">systemLangCode</code> should follow the ISO 639-1 standard.</li> </ul> <p>Example:</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">apiSettings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ApiSettings</span><span class="p">(</span><span class="m">45654</span><span class="p">,</span> <span class="s">"63h4ofskqp045jsl204h"</span><span class="p">,</span> <span class="s">"Raspberry Pi"</span><span class="p">,</span> <span class="s">"1.0"</span><span class="p">,</span> <span class="s">"en"</span><span class="p">,</span> <span class="s">"tdesktop"</span><span class="p">,</span> <span class="s">"en"</span><span class="p">,</span> <span class="s">"1.0"</span><span class="p">);</span>
</code></pre></div></div> <h2 id="session-settings"> <a href="#session-settings" class="anchor-heading" aria-labelledby="session-settings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Session Settings </h2> <p>Session settings are used by CatraProto to know where to store both the session and data received by Telegram.</p> <ul> <li> <p>The <code class="language-plaintext highlighter-rouge">sessionSerializer</code> parameter takes an instance of <a href="https://github.com/CatraProto/Client/blob/master/src/CatraProto.Client/MTProto/Session/Interfaces/IAsyncSessionSerializer.cs">IAsyncSessionSerializer</a> and uses it to serialize the session.</p> <p>CatraProto provides a <a href="https://github.com/CatraProto/Client/blob/master/src/CatraProto.Client/MTProto/Session/Deserializers/FileSerializer.cs">FileSerializer</a>. It only requires a parameter:</p> <ul> <li><code class="language-plaintext highlighter-rouge">filePath</code> where the session will be saved. You can also implement your own IAsyncSessionSerializer.</li> </ul> </li> <li> <p>The <code class="language-plaintext highlighter-rouge">databaseSettings</code> parameter takes an instance of <a href="https://github.com/CatraProto/Client/blob/master/src/CatraProto.Client/MTProto/Settings/DatabaseSettings.cs">DatabaseSettings</a>.</p> <p>DatabaseSettings’ constructor requires two parameters:</p> <ul> <li><code class="language-plaintext highlighter-rouge">path</code> which specifies a path where the persistent cache will be created.</li> <li><code class="language-plaintext highlighter-rouge">peerCacheSize</code> which is the maximum number of elements for the in-memory peer cache.</li> </ul> </li> <li> <p>The <code class="language-plaintext highlighter-rouge">sessionName</code> parameters takes a string specifying the name of the session which will be used to write logs.</p> </li> </ul> <p>To not create confusion, it is recommended to give the session a <em>.catra</em> extension and a <em>.db</em> extension to the database.</p> <p>Example:</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">sessionSettings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SessionSettings</span><span class="p">(</span><span class="k">new</span> <span class="nf">FileSerializer</span><span class="p">(</span><span class="s">"data/accountSession.catra"</span><span class="p">),</span> <span class="k">new</span> <span class="nf">DatabaseSettings</span><span class="p">(</span><span class="s">$"data/accountData.db"</span><span class="p">,</span> <span class="m">50</span><span class="p">),</span> <span class="s">"Private account"</span><span class="p">);</span>
</code></pre></div></div> <h2 id="connection-settings"> <a href="#connection-settings" class="anchor-heading" aria-labelledby="connection-settings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connection Settings </h2> <p>Connection settings are used to specify the default MTProto server, PFS key duration and other connection settings.</p> <ul> <li>The <code class="language-plaintext highlighter-rouge">defaultDatacenter</code> parameter takes an instance of <a href="https://github.com/CatraProto/Client/blob/master/src/CatraProto.Client/Connections/ConnectionInfo.cs">ConnectionInfo</a>. <br /> ConnectionInfo takes the following parameters: <ul> <li><code class="language-plaintext highlighter-rouge">IPAddress</code> takes an instance of <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.ipaddress">IPAddress</a>. It is used to specify the IP of the <strong>default datacenter</strong>. You can get information about your default datacenter by following these <a href="/configuration/app_configuration.html">instructions</a>.</li> <li><code class="language-plaintext highlighter-rouge">port</code> specifies the port to be used in order to connect to the datacenter. You can find it in your app’s configuration. You can find it right after the “:” in the IP address.</li> <li><code class="language-plaintext highlighter-rouge">dcId</code> used to specify which DC we are connecting to. You can find what DC has been assigned to your app just under the IP address. <strong>If this value is incorrect the library won’t be able to perform many operations such as logging in correctly</strong>.</li> <li><code class="language-plaintext highlighter-rouge">test</code> specifies whether the DC we are connecting to is a test DC. It is <strong>very important</strong> to make sure this parameter is correct otherwise CatraProto <strong>won’t</strong> be able to communicate with the API.</li> </ul> </li> <li>The <code class="language-plaintext highlighter-rouge">pfsKeyDuration</code> parameter specifies in seconds how long the PFS Key should last. When expired, the library will automatically generated a new one. This <strong>does not mean</strong> you will lose access to your session. <strong>One usually doesn’t need to change this parameter</strong>.</li> <li>The <code class="language-plaintext highlighter-rouge">connectionTimeout</code> parameter specifies in seconds how much time must elapse before reconnecting if the server does not reply.</li> <li>The <code class="language-plaintext highlighter-rouge">connectionRetry</code> parameter specifies in seconds how much the library must wait before trying to connect again after a failed attempt.</li> <li>The <code class="language-plaintext highlighter-rouge">ipv6Allowed</code> parameter specifies whether IPv6 is allowed or not.</li> <li>The <code class="language-plaintext highlighter-rouge">ipv6Only</code> parameter specifies whether only IPv6 must be used or not. This works only for connections that are not the default connection as Telegram only provides IPv4s.</li> </ul> <p>Example:</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">connectionInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConnectionInfo</span><span class="p">(</span><span class="n">IPAddress</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"149.154.167.50"</span><span class="p">),</span> <span class="m">443</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">connectionSettings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConnectionSettings</span><span class="p">(</span><span class="n">connectionInfo</span><span class="p">,</span> <span class="m">86400</span><span class="p">,</span> <span class="m">25</span><span class="p">,</span> <span class="m">15</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</code></pre></div></div> <h2 id="updates-settings"> <a href="#updates-settings" class="anchor-heading" aria-labelledby="updates-settings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Updates settings </h2> <p><strong>This is an optional parameter, you can skip this part if you’re not interested.</strong><br /> Currently, the only property exposed by the UpdatesSettings class is <code class="language-plaintext highlighter-rouge">queueUpdates</code> and when false it disables <a href="/receiving_updates.md#how-updates-are-delivered">this</a> behaviour.</p> <p>Example:</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">updatesSettings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">UpdatesSettings</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</code></pre></div></div> <h2 id="combining-every-setting-together"> <a href="#combining-every-setting-together" class="anchor-heading" aria-labelledby="combining-every-setting-together"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Combining every setting together </h2> <p>After having specified our configuration data and behaviour preferences we must put everything together.</p> <p>To do this, we use the <a href="https://github.com/CatraProto/Client/blob/master/src/CatraProto.Client/MTProto/Settings/ClientSettings.cs">ClientSettings</a> class. It simply takes the settings we have just created as parameters in the following order: <code class="language-plaintext highlighter-rouge">SessionSettings</code>, <code class="language-plaintext highlighter-rouge">ApiSettings</code>, <code class="language-plaintext highlighter-rouge">ConnectionSettings</code>. Optionally, <a href="#updates-settings">UpdatesSettings</a> are also accepted as last parameter.</p> <p>Example:</p> <div class="language-cs highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">clientSettings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ClientSettings</span><span class="p">(</span><span class="n">sessionSettings</span><span class="p">,</span> <span class="n">apiSettings</span><span class="p">,</span> <span class="n">connectionSettings</span><span class="p">);</span>
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
